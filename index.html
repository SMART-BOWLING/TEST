<!DOCTYPE html>
<html lang="ru">
<head>
  <!-- остальной код без изменений -->
  <style>
    /* остальные стили без изменений */
    
    .page-numbers {
      display: flex;
      gap: 6px;
      align-items: center;
      justify-content: center;
      flex-wrap: nowrap;
      flex-shrink: 0;
    }
  </style>
</head>
<body>
  <!-- остальной код без изменений -->
  
  <script>
    // остальной код без изменений
    
    function renderPageNumbers() {
      const pageContainer = document.getElementById("pageNumbers");
      pageContainer.innerHTML = "";
      const totalPages = Math.ceil(fullData.length / rowsPerPage);
      
      if (totalPages <= 1) return;
      
      // Всегда показываем первую страницу
      addPageButton(1, pageContainer);
      
      // Определяем диапазон страниц для отображения (максимум 3)
      let startPage = Math.max(2, currentPage - 1);
      let endPage = Math.min(totalPages - 1, currentPage + 1);
      
      // Корректируем диапазон, если он слишком мал
      if (currentPage <= 2) {
        endPage = Math.min(4, totalPages - 1);
      } else if (currentPage >= totalPages - 1) {
        startPage = Math.max(totalPages - 3, 2);
      }
      
      // Добавляем многоточие после первой страницы, если нужно
      if (startPage > 2) {
        const ellipsis = document.createElement("span");
        ellipsis.className = "ellipsis";
        ellipsis.textContent = "...";
        pageContainer.appendChild(ellipsis);
      }
      
      // Добавляем кнопки страниц в диапазоне
      for (let i = startPage; i <= endPage; i++) {
        if (i !== 1 && i !== totalPages) {
          addPageButton(i, pageContainer);
        }
      }
      
      // Добавляем многоточие перед последней страницей, если нужно
      if (endPage < totalPages - 1) {
        const ellipsis = document.createElement("span");
        ellipsis.className = "ellipsis";
        ellipsis.textContent = "...";
        pageContainer.appendChild(ellipsis);
      }
      
      // Всегда показываем последнюю страницу, если есть больше одной страницы
      if (totalPages > 1) {
        addPageButton(totalPages, pageContainer);
      }
    }

    function addPageButton(pageNumber, container) {
      const btn = document.createElement("button");
      btn.textContent = pageNumber;
      if (pageNumber === currentPage) btn.classList.add("active");
      btn.onclick = () => {
        currentPage = pageNumber;
        renderPage(currentPage);
        window.scrollTo({ top: 0, behavior: 'smooth' });
      };
      container.appendChild(btn);
    }
    
    // остальной код без изменений
  </script>
</body>
</html>